CREATE VIEW "METRIC2"."V_TS_DATA" ( "ID", "VALUE" ) AS SELECT TO_INT(TO_CHAR(DT_ADDED, 'HH24')) ID, AVG(TO_REAL(a.VALUE)) VALUE FROM METRIC2.M2_DWP_HISTORY a WHERE DASHBOARD_WIDGET_PARAM_ID = 771 GROUP BY TO_INT(TO_CHAR(DT_ADDED, 'HH24')), DASHBOARD_WIDGET_PARAM_ID ORDER BY TO_INT(TO_CHAR(DT_ADDED, 'HH24')) ASC WITH READ ONLY