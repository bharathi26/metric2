CREATE VIEW "METRIC2"."M2_WIDGET_DBMEM" ( "ALLOCATION_LIMIT", "TOTAL_MEMORY_USED_SIZE", "PEAK" ) AS select ROUND(m1.ALLOCATION_LIMIT/1024/1024/1024,2) as ALLOCATION_LIMIT, ROUND(m1.INSTANCE_TOTAL_MEMORY_USED_SIZE/1024/1024/1024) as TOTAL_MEMORY_USED_SIZE, ROUND((b1.PEAK+m1.INSTANCE_CODE_SIZE+ m1.INSTANCE_SHARED_MEMORY_ALLOCATED_SIZE)/1024/1024/1024,2)  as PEAK from SYS.M_HOST_RESOURCE_UTILIZATION m1  join (select a2.HOST as HOST, sum(ifnull (a1.INCLUSIVE_PEAK_ALLOCATION_SIZE,	 a2.HEAP_MEMORY_USED_SIZE)) as PEAK from SYS.M_SERVICE_MEMORY a2  left outer join (select HOST, PORT, INCLUSIVE_PEAK_ALLOCATION_SIZE from SYS.M_HEAP_MEMORY_RESET  where DEPTH = 0 ) as a1 on a2.HOST = a1.HOST and a2.PORT = a1.PORT group by a2.HOST) as b1 on m1.HOST = b1.HOST WITH READ ONLY