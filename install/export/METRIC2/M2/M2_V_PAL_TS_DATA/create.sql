CREATE VIEW "METRIC2"."M2_V_PAL_TS_DATA" ( "ID", "VALUE" ) AS SELECT TO_INT(TO_CHAR(UTCTOLOCAL(DT_ADDED, 'PST'), 'HH24')) ID, AVG(TO_REAL(a.VALUE)) VALUE FROM METRIC2.M2_DWP_HISTORY a WHERE DASHBOARD_WIDGET_PARAM_ID = 29 GROUP BY TO_INT(TO_CHAR(UTCTOLOCAL(DT_ADDED, 'PST'), 'HH24')), DASHBOARD_WIDGET_PARAM_ID ORDER BY TO_INT(TO_CHAR(UTCTOLOCAL(DT_ADDED, 'PST'), 'HH24')) ASC WITH READ ONLY